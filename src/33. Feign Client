# #33. Feign Client

- Definition

    In a microservice architecture, one service often needs to receive information from another service
    (for example, an "Order Service" calling a "Product Service"). Previously, `RestTemplate` was used for this, but this method required a lot of "boilerplate" (repeated) code.

- **Spring Feign Client**

    Spring Feign Client is a declarative REST client. This means that you simply create a **Java
    Interface** and decorate it with annotations. Spring Boot automatically creates an implementation
    for this interface and handles HTTP requests. It looks like you are calling a local method, but in
    reality the request is going to another service over the network.

- Step-by-Step Installation
    - Step 1: Adding Dependencies

        You must have `spring-cloud-starter-openfeign` library in your project (pom.xml or build.gradle).

        *Note: Spring Cloud versions must match Spring Boot version.*

        ![image.png](attachment:89c01161-4ca5-4e02-b395-717439d6ce38:image.png)

    - Step 2: Activating Feign Client

        Əsas tətbiq klassına (Main class) `@EnableFeignClients` annotasiyasını əlavə etməlisiniz. Bu,
        Spring-ə layihədəki Feign interfeyslərini axtarıb tapmağı əmr edir.

        ![image.png](attachment:0ab96dd5-d41a-4546-b130-9f7d1464abfe:image.png)

    - Step 3: Creating the Client Interface (Feign Interface)

        Now, create the interface that will talk to the service on the other side.

        Let's say we have a service called ProductService and we want to send a request to its address
        /products/{id}.

        ![image.png](attachment:d36e1542-6d2f-4a42-909a-edefbfbe5f8b:image.png)

    - Step 4: Client Injection

        You can use the `ProductClient` interface you have already created inside a regular Service or
        Controller with `@Autowired` (or constructor injection).

        ![image.png](attachment:0864fcc1-7cf5-4395-a050-e74f33532e73:image.png)

- Configuration

    Feign automatically offers timeouts and error handling. These can be configured in the
    `application.properties` file:

    ![image.png](attachment:c67f3eee-c0dd-4ecc-97d4-c6860d7951ae:image.png)

- Task

    **Task: "Currency Converter"**

    **Scenario:** You have a "Payment Service". The user makes a payment in AZN, but your system accepts
     USD. You need to find out the current exchange rate.

    **Requirements:**

    1. Find a free Currency API on the Internet (Example: *ExchangeRate-API* or *Frankfurter API*).
    - *Example URL:* `https://api.frankfurter.app/latest?from=USD&to=AZN`
    1. Create a Feign interface called `CurrencyClient` in your Spring Boot project.
    2. This interface should query that API and return the current exchange rate.
    3. Write a `convertPrice(double amount)` method that will take the exchange rate via Feign and
    calculate and print the amount.