# #27. SQL & JOINS #2

### **Module 1: SQL Fundamentals**

### Examples

- **`SELECT`, `FROM`, `WHERE`**
    - Purpose: To filter records based on a condition.
    - Syntax: `SELECT column1, column2 FROM TableName WHERE condition;`
    - Example: `SELECT FirstName, LastName FROM Employees WHERE DepartmentID = 101;`
- **`ORDER BY`**

    * Purpose: To sort the result set.
    * Syntax: `SELECT column1, column2 FROM TableName ORDER BY column1 [ASC|DESC];`
    * Example: `SELECT FirstName, LastName FROM Employees ORDER BY LastName ASC;`

- **Aggregate Functions & `GROUP BY`**

    * Purpose: To perform calculations on groups of rows.
    * Syntax: `SELECT column_group, AGGREGATE_FUNCTION(column_value) FROM TableName GROUP BY column_group;`
    * Example: `SELECT DepartmentID, COUNT(EmployeeID) AS NumberOfEmployees FROM Employees GROUP BY DepartmentID;`


### **Module 2: SQL JOINS - Combining Tables**

- **What are Keys?**
    - **Primary Key (PK):** Uniquely identifies each row in a table. `Employees.EmployeeID` and `Departments.DepartmentID` are PKs.
    - **Foreign Key (FK):** A field in one table that uniquely identifies a row of another table. `Employees.DepartmentID` is an FK referencing `Departments.DepartmentID`. This link is crucial for JOINS.
- **Types of JOINS**
    - **INNER JOIN**

        * **Purpose:** Returns records that have matching values in *both* tables. If there's no match, the record is excluded.
        * **Syntax:**`sql SELECT Columns FROM Table1 INNER JOIN Table2 ON Table1.MatchingColumn = Table2.MatchingColumn;`
        * **Example:** Get employees and their department names.
        `sql SELECT E.FirstName, E.LastName, D.DepartmentName FROM Employees E INNER JOIN Departments D ON E.DepartmentID = D.DepartmentID;` *(Only employees with a valid, matching DepartmentID in the Departments table will be shown.)*

    - **LEFT JOIN (or LEFT OUTER JOIN)**

        * **Purpose:** Returns all records from the *left* table (Table1) and the matched records from the *right* table (Table2). If there's no match in the right table, NULLs are returned for columns from the right table.
        * **Syntax:**`sql SELECT Columns FROM Table1 LEFT JOIN Table2 ON Table1.MatchingColumn = Table2.MatchingColumn;`
        * **Example:** Get all employees and their department names, even if an employee isn't assigned to a department yet.
        `sql SELECT E.FirstName, E.LastName, D.DepartmentName FROM Employees E LEFT JOIN Departments D ON E.DepartmentID = D.DepartmentID;` *(All employees will be listed. If an employee's DepartmentID doesn't exist in Departments, DepartmentName will be NULL.)*

    - **RIGHT JOIN (or RIGHT OUTER JOIN)**

        * **Purpose:** Returns all records from the *right* table (Table2) and the matched records from the *left* table (Table1). If there's no match in the left table, NULLs are returned for columns from the left table.
        * **Syntax:**`sql SELECT Columns FROM Table1 RIGHT JOIN Table2 ON Table1.MatchingColumn = Table2.MatchingColumn;`
        * **Example:** Get all departments and the employees in them, even if a department has no employees.
        `sql SELECT E.FirstName, E.LastName, D.DepartmentName FROM Employees E RIGHT JOIN Departments D ON E.DepartmentID = D.DepartmentID;` *(All departments will be listed. If a department has no employees, FirstName and LastName will be NULL.)*

    - **FULL JOIN (or FULL OUTER JOIN)**

        * **Purpose:** Returns all records when there is a match in either the left or right table. It essentially combines the results of a LEFT JOIN and a RIGHT JOIN. If there's no match, NULLs are returned for columns from the table without a match.
        * **Syntax:**`sql SELECT Columns FROM Table1 FULL OUTER JOIN Table2 ON Table1.MatchingColumn = Table2.MatchingColumn;`
        * **Example:** Get all employees and all departments, showing matches where they exist and NULLs otherwise.
        `sql SELECT E.FirstName, E.LastName, D.DepartmentName FROM Employees E FULL OUTER JOIN Departments D ON E.DepartmentID = D.DepartmentID;` *(Lists all employees (with NULL for department if no match) AND all departments (with NULL for employee details if no match).)Note: Some database systems like MySQL don't directly support `FULL OUTER JOIN`. You can achieve it using `UNION ALL` with a `LEFT JOIN` and a `RIGHT JOIN` (excluding overlaps).*

    - **SELF JOIN**
        - **Purpose:** To join a table to itself.
        - **When to use:** When a table has a self-referential relationship (e.g. `Employees.ManagerID` refers to another `Employees.EmployeeID` in the table). **Aliases** are mandatory.
- **Using Table Aliases in JOINS**

    As seen in examples (e.g., `Employees E`, `Departments D`), aliases make queries shorter and more readable, especially when column names are the same across tables or when performing SELF JOINS.

- **Joining Multiple Tables**

    You can join more than two tables by adding more `JOIN` clauses.

    - **Example:**

        Suppose you have `Orders` table with `CustomerID` and `Customers` table with `CustomerID`.

        SELECT C.CustomerName, E.FirstName AS EmployeeWhoHelped, O.OrderDate
        FROM Orders O
        INNER JOIN Customers C ON O.CustomerID = C.CustomerID
        INNER JOIN Employees E ON O.EmployeeID = E.EmployeeID;

- **Choosing the Right JOIN**
    - **INNER JOIN:** When you only want records that have a match in *both* tables. (e.g., "Show me customers *who have placed orders*.")
    - **LEFT JOIN:** When you want all records from the "left" table, plus any matching data from the "right". (e.g., "Show me *all customers*, and if they've placed orders, show those too.")
    - **RIGHT JOIN:** When you want all records from the "right" table, plus any matching data from the "left". (e.g., "Show me *all products*, and if they've been ordered, show customer details.") Often, a RIGHT JOIN can be rewritten as a LEFT JOIN by swapping table order.
    - **FULL JOIN:** When you want all records from *both* tables, matching them where possible. (e.g., "Show me all customers and all products, and link them if a customer ordered a product.")