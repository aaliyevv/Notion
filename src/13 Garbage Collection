# **#13** Garbage Collection

- **Java Memory Model Overview**

    Generally JVM memory  contains **Main Memory (Heap + Stack + Metaspace)**. Java uses **Heap Memory**
     for dynamic memory allocation. Garbage Collector (GC)  manages objects inside Heap. In stack When a
     method finishes executing, its frame is automatically removed from the stack. GC does not work here.
      **Burada GC işləmir.** Java heap memory is divided into different sections:

    Young Generation (Eden Space (New Object Creation) and Survivor Spaces) → Old Generation and Metaspace
    (Metadata)

    Long-living objects are moved to Old Generation after multiple GC cycles but after one GC cycle moved
    to **Survivor Spaces**

    ![image.png](attachment:0f765170-6aea-41e2-acb7-d94db8501f7c:image.png)

    Metadata (older name was PermGen): is not data itself, data about the data. For instance picture and
    the date when that picture was taken. The space of the Metadata is more permanent than others. PermGen:
     Permanent Generation

    GC mostly and often cleans up this small Young Generation space(Minor GC).

    When the Older Generation is full, the slower and more comprehensive Major GC is launched.

- **Importance of  Garbage Collection**
    - Improves application performance(reduce **memory leaks)**
    - Reduces the risk of `OutOfMemoryError` (JVM cant allocate a place for an object)
    - Simplifies memory management for developers(Unlike C++, programmer does not have to manually clean up
     memory)

- **Garbage Collection Process**

    1. **Mark Phase**: Identifies reachable(referenced) objects(marks as “live”).
    2. **Sweep Phase**: Removes unreferenced objects.
    3. **Compaction Phase**: Organizes memory by moving surviving objects closer together to reduce
    fragmentation.

    **Fragmentation**: Inefficient use of memory due to the allocation and deallocation of objects over
    time. This process leaves "gaps" or small, non-contiguous blocks of free memory spreaded throughout
    the heap. GC might need to work harder and more frequently to find suitable free blocks for new object
     allocations.

- **Objects that Eligible for GC**

    - Setting objects to `null`.
    - When an object no longer has references pointing to it or assigning a reference to another object.
    - Explicitly calling `System.gc()` (not recommended).

- **Default Garbage Collector in Java**

    The **default garbage collector** in Java depends on the **JDK version** and **JVM settings**:

    - **Java 8 and earlier** → **Parallel GC**
    - **Java 9 to 14** → **G1GC**
    - **Java 15 and later** → **G1GC (can also use ZGC or Shenandoah)**

    You can check the default GC used by the JVM with:

    java -XX:+PrintCommandLineFlags -version
